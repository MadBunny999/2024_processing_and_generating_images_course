# Практика №. Разные виды дистилляции

## Домашнее задание №

### Задание

В ходе домашнего задания попробуем разные виды дистилляции и их комбинации

### Датасет

Предлагается взять [CIFAR 10](https://paperswithcode.com/dataset/cifar-10), так как необходимо будет держать в памяти две архитектуры параллельно.

## Пререквизит
1. Обучить архитектуру которая далее будет считаться "Учителем"
2. Обучить архитектуру которая далее будет считаться "Студентом" (архитектура должна быть слабее "Учителя")
3. Сравнить метрики

![standart_method](assets/standart_method.png "standart_method")

## Эксперимент 1 - Дистилляция логитов
1. Измените тренировочный цикл так, чтобы параллельно в две архитектуры подавались семплы, при этом в Учителя должно быть отколючено обновление градиентов (torch.no_grad())
2. Изменить функцию ошибки

![standart_method](assets/distill_logits.png "standart_method")

## Эксперимент 2 - Учим студента совпадать по скрытому состоянию с учителем (без модификации и обучения архитектур)
1. Привести какие либо блоки скрытого пространства учителя и студента к одной размерности
2. Изменить добавить в целевую функцию ошибки cosine loss между фичами студента и учителя

![standart_method](assets/distill_pooling.png "standart_method")

## Эксперимент 3 - Добавляем обучаемый регрессор
1. Добавить в архитектуру новый блок который может обучаться (conv2d)
2. Изменить добавить в целевую функцию ошибки MSE loss между фичами студента и учителя

![standart_method](assets/distill_regressor.png "standart_method")

## Эксперимент бонус - комбинированный лосс
1. Попробуйте что-то то, что не было в ДЗ, например скомбинируйте несколько дистилляций
2. Попробуйте иммитировать активацию фичмап
3. Попробуйте N блок учителя на N-1 блок студента

![standart_method](assets/bonus.png "standart_method")

### Общие требования к выполнению


##### Результаты обучения
Секция с результатами обучения должна содержать:
1. График лосс функции в процессе обучения
2. График метрик на валидационной выборке во время обучения
3. 5-10 примеров изображений с результатом работы сети
4. Значения метрик
